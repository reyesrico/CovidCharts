(this["webpackJsonpcovid-charts"]=this["webpackJsonpcovid-charts"]||[]).push([[0],{188:function(e,t,a){},246:function(e,t,a){e.exports=a(475)},251:function(e,t,a){},428:function(e,t,a){},445:function(e,t,a){},449:function(e,t){},450:function(e,t){},461:function(e,t){},464:function(e,t){},465:function(e,t){},466:function(e,t,a){},467:function(e,t,a){},468:function(e,t,a){},469:function(e,t,a){},470:function(e,t,a){},474:function(e,t,a){},475:function(e,t,a){"use strict";a.r(t);var n=a(4),r=a.n(n),i=a(52),o=a.n(i),c=(a(251),a(27)),l=a(5),s=a(9),u=a(13),d=a(14),h=a(87),p=a(38),m=a(35),f=a(33),v=(a(428),function(e){var t=e.options,a=e.selected,n=e.onChange;return r.a.createElement("div",{className:"chart-options"},t.map((function(e,t){return r.a.createElement("label",{key:t},r.a.createElement("input",{type:"radio",name:"vote",value:e.value,key:t,checked:a===e.value,onChange:n}),e.text)})))}),y=a(86),g=a.n(y),E={"cache-control":"no-cache","x-apikey":"5c932ad1cac6621685acc11e"},b=function(){return"https://api.covid19api.com/countries"},O=function(e){return"https://api.covid19api.com/dayone/country/".concat(e)},C=function(e){return g.a.get(O(e),{headers:E})},S=a(30),D=a.n(S),j=function(e){return e&&e.some((function(e){return""!==e.Province}))},w=function(e){return e&&e.some((function(e){return""!==e.City}))},k=function(e){var t={};return e.forEach((function(e){var a=""===e.Province?"Undefined":e.Province,n=""===e.City?"Undefined":e.City,r=Object(c.a)(Object(c.a)({},e),{},{Province:a,City:n});Object.keys(t).includes(r.Province)?t[r.Province].push(r):t=Object(c.a)(Object(c.a)({},t),{},Object(f.a)({},r.Province,[r]))})),t},_=function(e,t){return e[t.label].map((function(e){return e.City})).filter((function(e,t,a){return a.indexOf(e)===t})).sort().map((function(e){return{value:e,name:e,label:e}}))},x=function(e,t,a){return e[t.label].filter((function(e){return e.City===a.label}))},N=function(e){if(e.length){for(var t=e[0],a=[t.Confirmed],n=[t.Deaths],r=1;r<e.length;r++){t=e[r];var i=e[r-1];a[r]=t.Confirmed-i.Confirmed,n[r]=t.Deaths-i.Deaths}return e.map((function(e,t){return Object(c.a)(Object(c.a)({},e),{},{Confirmed:a[t]})}))}},I=function(e){return Object.keys(e).sort().map((function(e){return{name:e,label:e,value:e}}))},P=function(e){return e.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{Date:D()(e.Date).format("MMM Do")})}))},M=(a(445),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={isLoading:!1,countryData:[],yValues:[{value:"Confirmed",text:"Confirmed"},{value:"Deaths",text:"Deaths"},{value:"Recovered",text:"Recovered"},{value:"Active",text:"Active"}],selectedY:"Confirmed"},e.getCountryInfo=function(){var t=e.props,a=t.countryCompare,n=t.hasProvinces;e.setState({countryData:[]}),n||(e.setState({isLoading:!0}),C(a.value).then((function(t){return e.setState({countryData:t.data})})).finally((function(){return e.setState({isLoading:!1})})))},e.getData=function(){var t=e.props,a=t.data,n=t.countryCompare,r=e.state,i=r.countryData,o=r.selectedY,l=[];if(a.length&&i.length){var s={};i.forEach((function(e){s=Object(c.a)(Object(c.a)({},s),{},Object(f.a)({},e.Date,e))})),l=a.map((function(e){var t,a=s[e.Date];return t={},Object(f.a)(t,e.Country,e[o]),Object(f.a)(t,n.label,a?a[o]:0),Object(f.a)(t,"Date",e.Date),t}))}return l},e.renderChart=function(){var t=e.props.width,a=e.getData();if(!a||!a.length)return r.a.createElement("div",null,"Data no available");a=P(a);var n=Object.keys(a[0]);return r.a.createElement(p.b,{width:t,height:250,data:a,margin:{top:10,right:30,left:0,bottom:0}},r.a.createElement("defs",null,r.a.createElement("linearGradient",{id:"color1",x1:"0",y1:"0",x2:"0",y2:"1"},r.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),r.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})),r.a.createElement("linearGradient",{id:"color2",x1:"0",y1:"0",x2:"0",y2:"1"},r.a.createElement("stop",{offset:"5%",stopColor:"#8884d8",stopOpacity:.8}),r.a.createElement("stop",{offset:"95%",stopColor:"#8884d8",stopOpacity:0}))),r.a.createElement(p.e,{dataKey:"Date"}),r.a.createElement(p.f,null),r.a.createElement(p.c,{strokeDasharray:"3 3"}),r.a.createElement(p.d,null),r.a.createElement(p.a,{type:"monotone",dataKey:n[0],stroke:"#82ca9d",fillOpacity:1,fill:"url(#color1)"}),r.a.createElement(p.a,{type:"monotone",dataKey:n[1],stroke:"#8884d8",fillOpacity:1,fill:"url(#color2)"}))},e.renderOptions=function(){var t=e.state,a=t.yValues,n=t.selectedY;return r.a.createElement("div",{className:"compare-chart__options"},r.a.createElement("div",{className:"compare-chart__values"},"Values (Y Axis)"),r.a.createElement(v,{options:a,selected:n,onChange:function(t){return t&&e.setState({selectedY:t.target.value})}}))},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.getCountryInfo()}},{key:"componentDidUpdate",value:function(e,t){var a=this.props.countryCompare;Object(m.isEqual)(e.countryCompare,a)||this.getCountryInfo()}},{key:"render",value:function(){return this.props.hasProvinces?r.a.createElement("div",null,"Country not available to compare"):r.a.createElement("div",{className:"compare-chart"},this.renderOptions(),r.a.createElement("hr",null),this.renderChart())}}]),a}(n.Component)),z=a(17),T=a(29),V=a(53),A=a.n(V),L=a(58),R=a.n(L),F=a(215),Y=a.n(F),q=(a(466),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"getSize",value:function(){switch(this.props.size){case"sm":return 8;case"md":return 16;case"lg":return 32;case"xl":return 64;default:return 8}}},{key:"render",value:function(){var e=this.props,t=e.message,a=e.showProgress,n=this.getSize();return r.a.createElement("div",{className:a?"stuffie-loading-progress":"stuffie-loading"},r.a.createElement(Y.a,{type:"spin",color:"#00f",height:n,width:n}),t&&r.a.createElement("div",{className:"stuffie-loading__message"},t))}}]),a}(n.Component)),G={chart:{height:250,zoomType:"x"},title:{text:""},legend:{enabled:!1},xAxis:{type:"datetime"},tooltip:{shared:!0},credits:{enabled:!1},plotOptions:{areaspline:{fillOpacity:.1}}},U=(a(467),function(e,t,a){return new Promise((function(n,r){var i=[],o=[],c=e.length,l=e.map((function(e){return e[t]})),s=K(l,X(l),H(l)),u=s.data;try{for(var d=a;d<c;d++){for(var h=d-a;h<d;h++)i.push(u[h]);o.push(u[d])}}catch(p){n(p),console.log(p)}return n({size:c-a,timePortion:a,trainX:i,trainY:o,min:s.min,max:s.max,originalData:l})}))}),B=function(e,t){for(var a=e.length,n=[],r=a-t;r<a;r++)n.push(e[r]);return n},K=function(e,t,a){return{data:e.map((function(e){return(e-t)/(a-t)})),min:t,max:a}},W=function(e,t,a){return{data:e.map((function(e){return e*(a-t)+t})),min:t,max:a}},X=function(e){return Math.min.apply(Math,Object(z.a)(e))},H=function(e){return Math.max.apply(Math,Object(z.a)(e))};Date.prototype.addDays=function(e){var t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t};var J=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={epochs:100,timePortion:7,predictedData:[],predictedDates:[],isLoading:!1,message:"",error:null,model:{predict:function(e){}},wait:!1},e.buildCnn=function(e){return new Promise((function(t,a){var n=T.c();return n.add(T.a.inputLayer({inputShape:[7,1]})),n.add(T.a.conv1d({kernelSize:2,filters:128,strides:1,useBias:!0,activation:"relu",kernelInitializer:"VarianceScaling"})),n.add(T.a.averagePooling1d({poolSize:[2],strides:[1]})),n.add(T.a.conv1d({kernelSize:2,filters:64,strides:1,useBias:!0,activation:"relu",kernelInitializer:"VarianceScaling"})),n.add(T.a.averagePooling1d({poolSize:[2],strides:[1]})),n.add(T.a.flatten({})),n.add(T.a.dense({units:1,kernelInitializer:"VarianceScaling",activation:"linear"})),n?t({model:n,data:e}):a("Model not created")}))},e.cnn=function(e,t,a){return e.summary(),new Promise((function(n,r){try{e.compile({optimizer:"adam",loss:"meanSquaredError"}),e.fit(t.tensorTrainX,t.tensorTrainY,{epochs:a}).then((function(t){n(e)}))}catch(i){r(i)}}))},e.loadData=function(){var t=e.props,a=t.data,n=t.type,r=e.state,i=r.timePortion,o=r.epochs,c=a.map((function(e){return e.Date}));e.setState({isLoading:!0,message:"Processing..."}),U(a,n,i).then((function(t){var a=B(t.originalData,t.timePortion);e.setState({message:"Building CNN "}),e.buildCnn(t).then((function(t){var n={tensorTrainX:T.d(t.data.trainX).reshape([t.data.size,t.data.timePortion,1]),tensorTrainY:T.d(t.data.trainY)},r=t.data.max,i=t.data.min;e.setState({message:"Getting model"}),e.cnn(t.model,n,o).then((function(o){e.setState({model:o});var l=o.predict(n.tensorTrainX),s=K(a,i,r),u=T.d(s.data).reshape([1,t.data.timePortion,1]),d=o.predict(u);e.setState({message:"Getting predictedValue data"}),d.data().then((function(t){var a=W(t,i,r);e.setState({message:"Finishing and cleaning data "}),l.data().then((function(t){var n=W(t,i,r);n.data=Array.prototype.slice.call(n.data),n.data=[].concat(Object(z.a)(n.data),Object(z.a)(a.data)),e.setState({predictedData:n.data,predictedDates:c,isLoading:!1,message:""})}))}))}),(function(t){return e.setState({error:t,isLoading:!1})}))}),(function(t){return e.setState({error:t,isLoading:!1})}))}))},e.predictMore=function(){var t=e.state,a=t.predictedData,n=t.timePortion,r=t.model;e.setState({wait:!0});var i=Object(z.a)(a),o=B(i,n),c=X(a),l=H(a),s=K(o,c,l),u=T.d(s.data).reshape([1,n,1]);r.predict(u).data().then((function(t){var n=W(t,c,l);n.data=Array.prototype.slice.call(n.data),e.setState({predictedData:[].concat(Object(z.a)(a),Object(z.a)(n.data)),wait:!1})}))},e.getSeries=function(){var t=e.props,a=t.data,n=t.type,r=e.state,i=r.predictedData,o=r.predictedDates,c=r.timePortion,l=[],s=a.map((function(e){return[D()(e.Date).valueOf(),e.Confirmed]})),u=null,d=[];return i.length&&o.length&&(u=i.map((function(e,t){var a=o.length>t+c?D()(o[t+c]):d[d.length-1].add(1,"days");return d.push(a),[a.valueOf(),e]}))),l.push({type:"area",name:n,data:s}),u&&l.push({type:"line",name:"Predicted ".concat(n),data:u,color:"#FF00FF"}),l},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.loadData()}},{key:"componentDidUpdate",value:function(e,t){Object(m.isEqual)(e,this.props)||this.loadData()}},{key:"renderChart",value:function(){var e=this.props.width,t=Object(c.a)(Object(c.a)({},G),{},{chart:Object(c.a)(Object(c.a)({},G.chart),{},{width:e}),series:this.getSeries()});return r.a.createElement(R.a,{highcharts:A.a,options:t})}},{key:"render",value:function(){var e=this,t=this.state,a=t.isLoading,n=t.message,i=t.error,o=t.wait;return r.a.createElement("div",{className:"covid-predictions"},a&&r.a.createElement(q,{size:"lg",message:n,showProgress:!0}),i&&r.a.createElement("div",null,"Couldn't load chart: ",i),!a&&!i&&this.renderChart(),!a&&!i&&r.a.createElement("button",{disabled:o,onClick:function(t){return t&&e.predictMore()}},"Predict next day!"))}}]),a}(n.Component),$=(a(468),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"footer"},r.a.createElement("div",null,"Covid Charts\u2122 is a platform coded by \xa0",r.a.createElement("a",{href:"http://stuffie.azurewebsites.net/PM_Carlos-Reyes2.html",target:"_blank",rel:"noopener noreferrer"},"Carlos Reyes-Rico"),"."),r.a.createElement("div",null,"Why?: Click ",r.a.createElement("a",{href:"https://github.com/reyesrico/CovidCharts/blob/master/README.md"},"here")),r.a.createElement("div",null,"Code: ",r.a.createElement("a",{href:"https://github.com/reyesrico/CovidCharts"},"https://github.com/reyesrico/CovidCharts")),r.a.createElement("div",null,"Contact and Follow Me! Twitter: ",r.a.createElement("a",{href:"https://twitter.com/reyesrico"},"@reyesrico")))}}]),a}(n.Component)),Q=(a(469),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.countrySelected;return r.a.createElement("div",{className:"instructions"},r.a.createElement("h4",{className:"instructions__title"},"Instructions"),r.a.createElement("ol",{className:"instructions__list"},r.a.createElement("li",null,"Select a country"),r.a.createElement("li",null,"If country has states data: select a state"),r.a.createElement("li",null,"If country has cities data: select a city")),r.a.createElement("div",{className:"instructions__examples"},r.a.createElement("div",null,"Flatten Curves Examples: ",r.a.createElement("b",null,"Germany, Korea (South), United States (NY, NY)")),r.a.createElement("button",{className:"instructions__button",onClick:function(t){return t&&localStorage.setItem("country",e.value)}},"Save Default Country")))}}]),a}(n.Component)),Z=(a(470),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={series:{},yValues:{Confirmed:!0,Deaths:!1,Recovered:!1,Active:!1,ConfirmedInc:!1,DeathsInc:!1,RecoveredInc:!1,ActiveInc:!1}},e.clearYValues=function(){var t={};Object.keys(e.state.yValues).forEach((function(e){var a="Confirmed"===e;t=Object(c.a)(Object(c.a)({},t),{},Object(f.a)({},e,a))})),e.setState({yValues:t})},e.yValuesFalse=function(){return!Object.values(e.state.yValues).reduce((function(e,t){return e||t}))},e.renderOptions=function(){var t=e.state.yValues;return r.a.createElement("div",{className:"make-chart__options"},r.a.createElement("div",{className:"make-chart__values"},"Values (Y Axis)"),Object.keys(t).map((function(a,n){var i=t[a];return r.a.createElement("div",{key:n},r.a.createElement("input",{checked:i,type:"checkbox",name:"yaxis",value:a,id:a,onChange:function(t){return t&&e.changeInput(a)}}),a)})))},e.getData=function(){var t=e.props.data,a=e.state.yValues;if(!e.yValuesFalse()){var n=[],r=[],i=[],o=[],c=[],l=[],s=[],u=[];t.forEach((function(e,d){if(a.Confirmed&&n.push([D()(e.Date).valueOf(),e.Confirmed]),a.Deaths&&r.push([D()(e.Date).valueOf(),e.Deaths]),a.Recovered&&i.push([D()(e.Date).valueOf(),e.Recovered]),a.Active&&o.push([D()(e.Date).valueOf(),e.Active]),0===d)a.ConfirmedInc&&c.push([D()(e.Date).valueOf(),0]),a.DeathsInc&&l.push([D()(e.Date).valueOf(),0]),a.RecoveredInc&&s.push([D()(e.Date).valueOf(),0]),a.ActiveInc&&u.push([D()(e.Date).valueOf(),0]);else{var h=t[d-1];a.ConfirmedInc&&c.push([D()(e.Date).valueOf(),e.Confirmed-h.Confirmed]),a.DeathsInc&&l.push([D()(e.Date).valueOf(),e.Deaths-h.Deaths]),a.RecoveredInc&&s.push([D()(e.Date).valueOf(),e.Recovered-h.Recovered]),a.ActiveInc&&u.push([D()(e.Date).valueOf(),e.Active-h.Active])}}));var d=[];a.Confirmed&&d.push({type:"area",name:"Confirmed",data:n}),a.Deaths&&d.push({type:"area",name:"Deaths",data:r}),a.Recovered&&d.push({type:"area",name:"Recovered",data:i}),a.Active&&d.push({type:"area",name:"Active",data:o}),a.ConfirmedInc&&d.push({type:"area",name:"ConfirmedInc",data:c}),a.DeathsInc&&d.push({type:"area",name:"DeathsInc",data:l}),a.RecoveredInc&&d.push({type:"area",name:"RecoveredInc",data:s}),a.ActiveInc&&d.push({type:"area",name:"ActiveInc",data:u}),e.setState({series:d})}},e.renderChart=function(){var t=e.props.width,a=e.state.series,n=Object(c.a)(Object(c.a)({},G),{},{chart:Object(c.a)(Object(c.a)({},G.chart),{},{width:t}),series:a});if(!Object(m.isEmpty)(a))return r.a.createElement(R.a,{highcharts:A.a,options:n})},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.getData()}},{key:"componentDidUpdate",value:function(e,t){var a=this.state.yValues;Object(m.isEqual)(t.yValues,a)||(this.yValuesFalse()?this.clearYValues():this.getData())}},{key:"changeInput",value:function(e){var t=this.state.yValues[e],a=Object(c.a)({},this.state.yValues);a[e]=!t,this.setState({yValues:a})}},{key:"render",value:function(){return r.a.createElement("div",{className:"make-chart"},this.renderOptions(),r.a.createElement("hr",null),this.renderChart())}}]),a}(n.Component)),ee=a(3),te=a.n(ee),ae=a(12);function ne(e,t,a){for(var n=[],r=0;r<=e.length-a;r++){for(var i=0,o=r+a,c=r;c<o&&c<=e.length;c++)i+=e[c][t]/a;n.push({set:e.slice(r,r+a),avg:i})}return n}function re(e,t,a,n,r,i,o,c){return ie.apply(this,arguments)}function ie(){return(ie=Object(ae.a)(te.a.mark((function e(t,a,n,r,i,o,c,l){var s,u,d,h,p,m,f,v,y,g,E;return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s=r,100,10,10,u=[10,10],20,d=r,20,1,h=T.c(),p=t.slice(0,Math.floor(n/100*t.length)),m=a.slice(0,Math.floor(n/100*a.length)),f=T.e(p,[p.length,p[0].length]).div(T.b(10)),v=T.e(m,[m.length,1]).reshape([m.length,1]).div(T.b(10)),h.add(T.a.dense({units:100,inputShape:[s]})),h.add(T.a.reshape({targetShape:u})),y=[],g=0;g<c;g++)y.push(T.a.lstmCell({units:20}));return h.add(T.a.rnn({cell:y,inputShape:u,returnSequences:!1})),h.add(T.a.dense({units:1,inputShape:[20]})),h.compile({optimizer:T.f.adam(o),loss:"meanSquaredError"}),e.next=23,h.fit(f,v,{batchSize:d,epochs:i,callbacks:{onEpochEnd:function(){var e=Object(ae.a)(te.a.mark((function e(t,a){return te.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l(t,a);case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()}});case 23:return E=e.sent,e.abrupt("return",{model:h,stats:E});case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(e,t,a){var n=e.slice(Math.floor(t/100*e.length),e.length),r=a.predict(T.e(n,[n.length,n[0].length]).div(T.b(10))).mul(10);return console.log(r),Array.from(r.dataSync())}a(188);var ce=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={projectedData:[],trainedData:[],modelTrained:{},readingEpoch:0,windowSize:7,epochSize:10,trainingSize:70,learningRate:.1,hiddenLayers:1,predValues:[],predTimestamps:[],loadingTrain:!1},e.clearState=function(){var t=e.props,a=t.data,n=t.type,r=e.state.windowSize;e.setState({projectedData:[],trainedData:ne(a,n,r),modelTrained:{},readingEpoch:0,windowSize:7,epochSize:7,trainingSize:70,learningRate:.1,hiddenLayers:1,predValues:[],predTimestamps:[],loadingTrain:!1})},e.getSeries=function(t){var a=e.props,n=a.data,r=a.type,i=e.state,o=i.predValues,c=i.predTimestamps,l=i.trainedData,s=i.windowSize,u=[],d=[],h=[],p=[],m=0;return n.forEach((function(e,t){if(d.push([D()(e.Date).valueOf(),e[r]]),t>=s){var a=l[m++];h.push([D()(e.Date).valueOf(),Math.round(a.avg)])}})),t&&o.forEach((function(e,t){p.push([D()(c[t]).valueOf(),Math.round(e)])})),u.push({type:"area",name:r,data:d}),u.push({type:"line",name:"Trained",data:h}),u.push({type:"line",name:"Predicted",data:p,color:"#FF00FF"}),u},e.trainModel=Object(ae.a)(te.a.mark((function t(){var a,n,r,i,o,c,l,s,u,d,h,p,m,f,v,y,g;return te.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.type,n=e.state,r=n.trainedData,i=n.trainingSize,o=n.windowSize,c=n.epochSize,l=n.learningRate,s=n.hiddenLayers,e.setState({loadingTrain:!0}),u=[],d=r.map((function(e){return e.set.map((function(e){return e[a]}))})),h=r.map((function(e){return e.avg})),p=i,m=c,f=l,v=s,y=function(t,a){e.setState({readingEpoch:t+1}),u.push(a.loss)},t.next=13,re(d,h,p,o,m,f,v,y);case 13:g=t.sent,console.log(g),console.log(u),e.setState({modelTrained:g,loadingTrain:!1});case 17:case"end":return t.stop()}}),t)}))),e.predict=function(){var t=e.props,a=t.data,n=t.type,r=e.state,i=r.trainedData,o=r.trainingSize,c=r.modelTrained,l=r.windowSize;if(!Object(m.isEmpty)(c)){var s=i.map((function(e){return e.set.map((function(e){return e[n]}))}));console.log(s);var u=i.map((function(e){return e.avg}));console.log(u);var d=o;console.log("data.length: ".concat(a.length)),console.log("trainedData.length: ".concat(i.length)),console.log("trainingsize: ".concat(d));var h=u.slice(Math.floor(d/100*u.length),u.length);console.log("outps (Expected)"),console.log(h);var p=oe(s,d,c.model);console.log("pred_vals"),console.log(p);var f=a.map((function(e){return e.Date})).splice(l+Math.floor(d/100*u.length),a.length);console.log(f),e.setState({predValues:p,predTimestamps:f})}},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.data,a=e.type,n=this.state.windowSize;this.setState({trainedData:ne(t,a,n)})}},{key:"componentDidUpdate",value:function(e,t){var a=this.props.data;Object(m.isEqual)(e.data,a)||this.clearState()}},{key:"renderChart",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.props.width,a=Object(c.a)(Object(c.a)({},G),{},{chart:Object(c.a)(Object(c.a)({},G.chart),{},{width:t}),series:this.getSeries(e)});return r.a.createElement(R.a,{highcharts:A.a,options:a})}},{key:"renderLoading",value:function(){var e=this.state,t=e.readingEpoch,a=e.epochSize,n=Math.floor(t/a*100);return r.a.createElement("div",{className:"projections__loading"},r.a.createElement("div",null,"Loading ".concat(n,"%")),r.a.createElement("progress",{id:"file",max:a,value:t}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.trainedData,n=t.modelTrained,i=t.loadingTrain,o=t.predValues;return a.length?r.a.createElement("div",{className:"projections"},r.a.createElement("h3",null,"SMA Computed"),a&&this.renderChart(),r.a.createElement("hr",null),r.a.createElement("h3",null,"Training"),r.a.createElement("button",{className:"projections__train-btn",onClick:function(t){return t&&e.trainModel()},disabled:i},"Train Model"),i&&this.renderLoading(),!i&&!Object(m.isEmpty)(n)&&r.a.createElement("div",{className:"projections__model-trained"},"Model Trained!"),r.a.createElement("hr",null),r.a.createElement("h3",null,"Validate"),r.a.createElement("button",{onClick:function(t){return t&&e.predict()},disabled:Object(m.isEmpty)(n)},"Predict (See Console)"),!!o.length&&this.renderChart(!0)):r.a.createElement("div",null,"Loading")}}]),a}(n.Component),le=a(471),se=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={isLoading:!1,predictions:[],period:7},e.getPredictions=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.95,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2,r=e.props,i=r.data,o=r.type,c=e.state.period,l=i.map((function(e){return e[o]})),s=l.length%c,u=l.slice(s),d=le(u,t,a,n,c,c);e.setState({predictions:d})},e.getSeries=function(){var t,a=e.props,n=a.data,r=a.type,i=e.state,o=i.predictions,c=i.period,l=[],s=n.length>=2&&n[0].Date&&n[1].Date&&D()(n[1].Date).valueOf()-D()(n[0].Date).valueOf()||0,u=n.length%c,d=n.map((function(e){return[D()(e.Date).valueOf(),e[r]]})),h=null===d||void 0===d||null===(t=d[0])||void 0===t?void 0:t[0],p=o.map((function(e,t){var a=t+u;return a<n.length?h=d[a][0]:h+=s,[h,e]}));return l.push({type:"area",name:r,data:d}),l.push({type:"line",name:"Predicted ".concat(r),data:p,color:"#FF00FF"}),l},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.getPredictions()}},{key:"componentDidUpdate",value:function(e){Object(m.isEqual)(e.data,this.props.data)||(this.setState({isLoading:!1,predictions:[],period:7}),this.getPredictions())}},{key:"renderChart",value:function(){var e=this.props.width,t=Object(c.a)(Object(c.a)({},G),{},{chart:Object(c.a)(Object(c.a)({},G.chart),{},{width:e}),series:this.getSeries()});return r.a.createElement(R.a,{highcharts:A.a,options:t})}},{key:"render",value:function(){var e=this.state.predictions;return r.a.createElement("div",{className:"projections"},r.a.createElement("h3",null,"Projections using Holt-Winters"),!e&&r.a.createElement("div",null,"No Predictions"),e&&!e.length&&r.a.createElement("div",null,"Loading"),e&&e.length&&this.renderChart(),r.a.createElement("hr",null))}}]),a}(n.Component),ue=(a(474),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={defaultCountrySlug:localStorage.getItem("country")||"mexico",menu:{fn:null},all:null,country:[],countryData:[],countries:[],countrySelected:{name:null,Country:"",value:"",label:null},countryCompare:{name:null,Country:"",value:"",label:null},isLoading:!1,provinces:[],provinceData:[],provinceSelected:{name:null,value:"",label:null},cities:[],citySelected:{name:null,value:"",label:null},usMap:{},isError:!1,width:500},e.getCountryInfo=function(){var t=e.state.countrySelected;e.setState({isLoading:!0,isError:!1}),C(t.value).then((function(t){var a,n,r,i,o,c=t.data;j(c)?(a=k(c),r=(n=I(a))[0],w(c)&&(o=(i=_(a,r))[0]),e.setState({usMap:a,country:c,cities:i,provinces:n,provinceSelected:r,citySelected:o})):e.setState({country:c,usMap:{},provinceSelected:{name:null},provinces:[],provinceData:[],citySelected:{name:null},cities:[]})})).catch((function(){return e.setState({isError:!0})})).finally((function(){return e.setState({isLoading:!1})}))},e.getData=function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.state,i=r.usMap,o=r.citySelected,c=r.provinceSelected,l=w(t)?x(i,c,o):j(t)?i[c.label]:t;return l=n?P(l):l,a?N(l):l},e.renderTitle=function(){var t,a,n=e.state,r=n.citySelected,i=n.provinceSelected,o=n.countrySelected;return null!==(t=null!==(a=null===r||void 0===r?void 0:r.label)&&void 0!==a?a:null===i||void 0===i?void 0:i.label)&&void 0!==t?t:o.label},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.state.defaultCountrySlug,a=window.innerWidth,n=a>=500?500:.8*a;g.a.get(b(),{headers:E}).then((function(a){var r=Object(m.sortBy)(a.data,["Slug"]),i=0,o=r.map((function(e,a){return e.Slug===t&&(i=a),Object(c.a)(Object(c.a)({},e),{},{value:e.Slug,label:e.Country,name:e.Slug})}));e.setState({countries:o,countrySelected:o[i],countryCompare:o[81],width:n})}))}},{key:"componentDidUpdate",value:function(e,t){if(this.state.isError)this.getCountryInfo();else if(!this.state.isLoading)if(Object(m.isEqual)(t.countrySelected,this.state.countrySelected)){if(!Object(m.isEqual)(t.provinceSelected,this.state.provinceSelected)&&w(this.state.country)){var a=_(this.state.usMap,this.state.provinceSelected);this.setState({cities:a,citySelected:a[0]})}}else this.getCountryInfo()}},{key:"renderChart",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.state.width,n=this.getData(e,t);return n&&n.length?r.a.createElement(p.b,{width:a,height:250,data:n,margin:{top:10,right:30,left:0,bottom:0}},r.a.createElement("defs",null,r.a.createElement("linearGradient",{id:"colorDeaths",x1:"0",y1:"0",x2:"0",y2:"1"},r.a.createElement("stop",{offset:"5%",stopColor:"#8884d8",stopOpacity:.8}),r.a.createElement("stop",{offset:"95%",stopColor:"#8884d8",stopOpacity:0})),r.a.createElement("linearGradient",{id:"colorConfirmed",x1:"0",y1:"0",x2:"0",y2:"1"},r.a.createElement("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),r.a.createElement("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0}))),r.a.createElement(p.e,{dataKey:"Date"}),r.a.createElement(p.f,null),r.a.createElement(p.c,{strokeDasharray:"3 3"}),r.a.createElement(p.d,null),r.a.createElement(p.a,{type:"monotone",dataKey:"Confirmed",stroke:"#82ca9d",fillOpacity:1,fill:"url(#colorConfirmed)"}),r.a.createElement(p.a,{type:"monotone",dataKey:"Deaths",stroke:"#8884d8",fillOpacity:1,fill:"url(#colorDeaths)"})):r.a.createElement("div",null,"No data")}},{key:"renderCompareChart",value:function(e){var t=this,a=this.state,n=a.country,i=a.countries,o=a.countryCompare,c=a.width;return r.a.createElement("div",{className:"covid__chart"},r.a.createElement("h3",{className:"covid__chart-text"},"Compare with other country"),r.a.createElement("div",{className:"covid__chart-select"},r.a.createElement(h.a,{onChange:function(e){return t.setState({countryCompare:e})},options:i,value:o})),n.length&&r.a.createElement(M,{data:this.getData(n,!1,!1),width:c,countryCompare:o,hasProvinces:e}))}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.country,i=a.countries,o=a.countrySelected,c=a.isLoading,l=a.provinces,s=a.provinceSelected,u=a.cities,d=a.citySelected,p=a.usMap,m=a.width,f=a.isError,v=null!==(e=o.label)&&void 0!==e?e:"Country";if(!i.length||c)return r.a.createElement(q,{size:"xl",message:"Loading ".concat(v," Data")});var y=j(n),g=w(n);return r.a.createElement("div",{className:"covid"},r.a.createElement("h2",{className:"covid__title"},"COVID ",o.label," Charts"),r.a.createElement("h3",{className:"covid__subtitle"},"Data Source: ",r.a.createElement("a",{href:"https://github.com/CSSEGISandData/COVID-19"},"Johns Hopkins CSSE")),r.a.createElement(Q,{countrySelected:o}),f&&r.a.createElement("div",{className:"covid__error"},"Error Getting Data: Try Again"),r.a.createElement("div",{className:"covid__dropdowns"},r.a.createElement(h.a,{onChange:function(e){return t.setState({countrySelected:e})},options:i,value:o}),y&&r.a.createElement(h.a,{onChange:function(e){return t.setState({provinceSelected:e})},options:l,value:s}),g&&r.a.createElement(h.a,{onChange:function(e){return t.setState({citySelected:e})},options:u,value:d})),r.a.createElement("hr",null),r.a.createElement("div",{className:"covid__charts"},r.a.createElement("h3",{className:"covid__chart-text"},"Total Confirmed and Deaths"),this.renderChart(n),r.a.createElement("hr",null),r.a.createElement("h3",{className:"covid__chart-text"},"Incremental Confirmed (To Date - One Day Before) and Deaths"),this.renderChart(n,!0),r.a.createElement("hr",null),!y&&this.renderCompareChart(y),r.a.createElement("hr",null),r.a.createElement("h3",{className:"covid__chart-text"},"Make Your Own ",this.renderTitle()," Chart"),r.a.createElement(Z,{countries:i,data:this.getData(n,!1,!1),map:p,width:m}),r.a.createElement("hr",null),r.a.createElement("div",{className:"covid__texts"},r.a.createElement("div",{className:"covid__text"},o.label),y&&r.a.createElement("div",{className:"covid__text"},null===s||void 0===s?void 0:s.label),g&&r.a.createElement("div",{className:"covid__text"},null===d||void 0===d?void 0:d.label)),r.a.createElement("hr",null),r.a.createElement("h3",{className:"covid__chart-text"},"Covid Preditions (based on StockPredictions)"),n.length&&r.a.createElement(J,{data:this.getData(n,!1,!1),type:"Confirmed",width:m}),r.a.createElement("hr",null),r.a.createElement("h3",{className:"covid__chart-text"},"Confirmed Type Projections Holt-Winter"),n.length&&r.a.createElement(se,{data:this.getData(n,!1,!1),type:"Confirmed",width:m}),r.a.createElement("hr",null),r.a.createElement("h3",{className:"covid__chart-text"},"Confirmed Type Projections"),n.length&&r.a.createElement(ce,{data:this.getData(n,!1,!1),type:"Confirmed",width:m})),r.a.createElement($,null))}}]),a}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ue,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[246,1,2]]]);
//# sourceMappingURL=main.1d55c40b.chunk.js.map